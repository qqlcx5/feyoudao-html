<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>从零搭建Vue3.0组件库之Transfer组件 | 珠峰架构师课</title>
    <meta name="description" content="前端进阶技术">

    
    <link rel="preload" href="../assets/css/0.styles.ae591a53.css" as="style"><link rel="preload" href="../assets/js/app.54b07399.js" as="script"><link rel="preload" href="../assets/js/2.ee950734.js" as="script"><link rel="preload" href="../assets/js/113.17422ed4.js" as="script"><link rel="prefetch" href="../assets/js/10.296ff359.js"><link rel="prefetch" href="../assets/js/100.f0df740b.js"><link rel="prefetch" href="../assets/js/101.e35e6b1f.js"><link rel="prefetch" href="../assets/js/102.c9702b71.js"><link rel="prefetch" href="../assets/js/103.0a1c79a0.js"><link rel="prefetch" href="../assets/js/104.5709d932.js"><link rel="prefetch" href="../assets/js/105.a4a52580.js"><link rel="prefetch" href="../assets/js/106.92acdef6.js"><link rel="prefetch" href="../assets/js/107.4b10c679.js"><link rel="prefetch" href="../assets/js/108.0eea1a7e.js"><link rel="prefetch" href="../assets/js/109.738b9c9b.js"><link rel="prefetch" href="../assets/js/11.5442bbbf.js"><link rel="prefetch" href="../assets/js/110.2fd442f8.js"><link rel="prefetch" href="../assets/js/111.880a371e.js"><link rel="prefetch" href="../assets/js/112.0b476aeb.js"><link rel="prefetch" href="../assets/js/114.75c7aae1.js"><link rel="prefetch" href="../assets/js/115.2f0ed527.js"><link rel="prefetch" href="../assets/js/116.db416260.js"><link rel="prefetch" href="../assets/js/117.0d8fcc1b.js"><link rel="prefetch" href="../assets/js/118.9ba049b0.js"><link rel="prefetch" href="../assets/js/119.d4a28dbe.js"><link rel="prefetch" href="../assets/js/12.b5fe332f.js"><link rel="prefetch" href="../assets/js/13.c5e38311.js"><link rel="prefetch" href="../assets/js/14.84804fb8.js"><link rel="prefetch" href="../assets/js/15.3362f3b6.js"><link rel="prefetch" href="../assets/js/16.14b892c1.js"><link rel="prefetch" href="../assets/js/17.61cf9dab.js"><link rel="prefetch" href="../assets/js/18.d078007c.js"><link rel="prefetch" href="../assets/js/19.8b85f184.js"><link rel="prefetch" href="../assets/js/20.bef254c3.js"><link rel="prefetch" href="../assets/js/21.ece8bff9.js"><link rel="prefetch" href="../assets/js/22.88f4fcb7.js"><link rel="prefetch" href="../assets/js/23.f6c93deb.js"><link rel="prefetch" href="../assets/js/24.194c1cfa.js"><link rel="prefetch" href="../assets/js/25.bb0e9d5b.js"><link rel="prefetch" href="../assets/js/26.4999ec27.js"><link rel="prefetch" href="../assets/js/27.b24d8af3.js"><link rel="prefetch" href="../assets/js/28.5a2aabc8.js"><link rel="prefetch" href="../assets/js/29.6e7d7a25.js"><link rel="prefetch" href="../assets/js/3.2659ed5c.js"><link rel="prefetch" href="../assets/js/30.03563a67.js"><link rel="prefetch" href="../assets/js/31.0ccc994a.js"><link rel="prefetch" href="../assets/js/32.a14734f9.js"><link rel="prefetch" href="../assets/js/33.de7abcf7.js"><link rel="prefetch" href="../assets/js/34.a6408e87.js"><link rel="prefetch" href="../assets/js/35.9336cc72.js"><link rel="prefetch" href="../assets/js/36.f9d9757f.js"><link rel="prefetch" href="../assets/js/37.69ce416f.js"><link rel="prefetch" href="../assets/js/38.46730894.js"><link rel="prefetch" href="../assets/js/39.260e8066.js"><link rel="prefetch" href="../assets/js/4.dfaa511c.js"><link rel="prefetch" href="../assets/js/40.f84a5946.js"><link rel="prefetch" href="../assets/js/41.4bf23420.js"><link rel="prefetch" href="../assets/js/42.ea53b11d.js"><link rel="prefetch" href="../assets/js/43.a53f2e52.js"><link rel="prefetch" href="../assets/js/44.eb5ec325.js"><link rel="prefetch" href="../assets/js/45.e85fed82.js"><link rel="prefetch" href="../assets/js/46.0b7cf0a7.js"><link rel="prefetch" href="../assets/js/47.ce36a4a1.js"><link rel="prefetch" href="../assets/js/48.35900a87.js"><link rel="prefetch" href="../assets/js/49.8a3a2b22.js"><link rel="prefetch" href="../assets/js/5.8c24f0b2.js"><link rel="prefetch" href="../assets/js/50.d82896f2.js"><link rel="prefetch" href="../assets/js/51.d038b2b9.js"><link rel="prefetch" href="../assets/js/52.390383f7.js"><link rel="prefetch" href="../assets/js/53.36b04cc7.js"><link rel="prefetch" href="../assets/js/54.a87b1dbe.js"><link rel="prefetch" href="../assets/js/55.136926ad.js"><link rel="prefetch" href="../assets/js/56.622bd6b1.js"><link rel="prefetch" href="../assets/js/57.33e506a7.js"><link rel="prefetch" href="../assets/js/58.032ba72f.js"><link rel="prefetch" href="../assets/js/59.41d4c9e7.js"><link rel="prefetch" href="../assets/js/6.01db0b2d.js"><link rel="prefetch" href="../assets/js/60.ab71301f.js"><link rel="prefetch" href="../assets/js/61.bf8f3d25.js"><link rel="prefetch" href="../assets/js/62.c232c534.js"><link rel="prefetch" href="../assets/js/63.6359a8b6.js"><link rel="prefetch" href="../assets/js/64.c68ff971.js"><link rel="prefetch" href="../assets/js/65.a76f76fc.js"><link rel="prefetch" href="../assets/js/66.aa18b3e5.js"><link rel="prefetch" href="../assets/js/67.14c96154.js"><link rel="prefetch" href="../assets/js/68.87ec0e62.js"><link rel="prefetch" href="../assets/js/69.b492b333.js"><link rel="prefetch" href="../assets/js/7.c8da167f.js"><link rel="prefetch" href="../assets/js/70.206d39ef.js"><link rel="prefetch" href="../assets/js/71.d0e6c431.js"><link rel="prefetch" href="../assets/js/72.47bbcb4e.js"><link rel="prefetch" href="../assets/js/73.b62daf77.js"><link rel="prefetch" href="../assets/js/74.92ca091d.js"><link rel="prefetch" href="../assets/js/75.7f60c1e2.js"><link rel="prefetch" href="../assets/js/76.2f50c739.js"><link rel="prefetch" href="../assets/js/77.4fb8dff7.js"><link rel="prefetch" href="../assets/js/78.72a743af.js"><link rel="prefetch" href="../assets/js/79.3bfa92c1.js"><link rel="prefetch" href="../assets/js/8.351504b7.js"><link rel="prefetch" href="../assets/js/80.f11f29d3.js"><link rel="prefetch" href="../assets/js/81.46cb8a88.js"><link rel="prefetch" href="../assets/js/82.90297a8e.js"><link rel="prefetch" href="../assets/js/83.feb9c5cc.js"><link rel="prefetch" href="../assets/js/84.807f1303.js"><link rel="prefetch" href="../assets/js/85.f0d847e6.js"><link rel="prefetch" href="../assets/js/86.8d54c147.js"><link rel="prefetch" href="../assets/js/87.94c84d8c.js"><link rel="prefetch" href="../assets/js/88.97cc3cc2.js"><link rel="prefetch" href="../assets/js/89.6fc029ab.js"><link rel="prefetch" href="../assets/js/9.9d4fbafa.js"><link rel="prefetch" href="../assets/js/90.f84d0f0e.js"><link rel="prefetch" href="../assets/js/91.5a1a2a2f.js"><link rel="prefetch" href="../assets/js/92.e900e1e7.js"><link rel="prefetch" href="../assets/js/93.9a1acd0b.js"><link rel="prefetch" href="../assets/js/94.65bde5bd.js"><link rel="prefetch" href="../assets/js/95.982505a0.js"><link rel="prefetch" href="../assets/js/96.dad97fc5.js"><link rel="prefetch" href="../assets/js/97.6b630dcc.js"><link rel="prefetch" href="../assets/js/98.04bd9692.js"><link rel="prefetch" href="../assets/js/99.33989902.js">
    <link rel="stylesheet" href="../assets/css/0.styles.ae591a53.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="../index.html" class="home-link router-link-active"><!----> <span class="site-name">珠峰架构师课</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">珠峰架构课</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="../vue-analyse/note-1.html" class="nav-link">源码解析</a></li><li class="dropdown-item"><!----> <a href="../vue-apply/note-1.html" class="nav-link">快速掌握Vue</a></li><li class="dropdown-item"><!----> <a href="../node/async-1.html" class="nav-link">快速掌握Node</a></li><li class="dropdown-item"><!----> <a href="../typescript/1.html" class="nav-link">深度学习TypeScript</a></li><li class="dropdown-item"><!----> <a href="../vue3/1.vue3-rollup.html" class="nav-link">Vue3原理手写</a></li><li class="dropdown-item"><!----> <a href="../opt/note.html" class="nav-link">渲染原理性能优化</a></li><li class="dropdown-item"><!----> <a href="1.html" class="nav-link">Z-UI组件库</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">珠峰架构课</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="../vue-analyse/note-1.html" class="nav-link">源码解析</a></li><li class="dropdown-item"><!----> <a href="../vue-apply/note-1.html" class="nav-link">快速掌握Vue</a></li><li class="dropdown-item"><!----> <a href="../node/async-1.html" class="nav-link">快速掌握Node</a></li><li class="dropdown-item"><!----> <a href="../typescript/1.html" class="nav-link">深度学习TypeScript</a></li><li class="dropdown-item"><!----> <a href="../vue3/1.vue3-rollup.html" class="nav-link">Vue3原理手写</a></li><li class="dropdown-item"><!----> <a href="../opt/note.html" class="nav-link">渲染原理性能优化</a></li><li class="dropdown-item"><!----> <a href="1.html" class="nav-link">Z-UI组件库</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="1.html" class="sidebar-link">从零搭建Vue3.0组件之环境搭建</a></li><li><a href="2.html" class="sidebar-link">从零搭建Vue3.0组件之布局组件</a></li><li><a href="3.html" class="sidebar-link">从零搭建Vue3.0组件库之checkbox组件</a></li><li><a href="4.html" class="active sidebar-link">从零搭建Vue3.0组件库之Transfer组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="#%E4%B8%80-%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E5%B1%9E%E6%80%A7" class="sidebar-link">一.定义组件属性</a></li><li class="sidebar-sub-header"><a href="#%E4%BA%8C-%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84" class="sidebar-link">二.定义组件结构</a></li><li class="sidebar-sub-header"><a href="#%E4%B8%89-%E5%AE%9E%E7%8E%B0%E7%A9%BF%E6%A2%AD%E5%8A%9F%E8%83%BD" class="sidebar-link">三.实现穿梭功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="#_1-%E5%B7%A6%E5%8F%B3%E9%9D%A2%E6%9D%BF%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E6%8B%86%E5%88%86" class="sidebar-link">1.左右面板数据进行拆分</a></li><li class="sidebar-sub-header"><a href="#_2-%E9%9D%A2%E6%9D%BF%E6%B8%B2%E6%9F%93%E5%86%85%E5%AE%B9" class="sidebar-link">2.面板渲染内容</a></li><li class="sidebar-sub-header"><a href="#_3-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E4%B8%AD%E7%9A%84%E5%80%BC" class="sidebar-link">3.获取当前选中的值</a></li><li class="sidebar-sub-header"><a href="#_4-%E7%A9%BF%E6%A2%AD%E5%AE%9E%E7%8E%B0" class="sidebar-link">4.穿梭实现</a></li></ul></li><li class="sidebar-sub-header"><a href="#%E5%9B%9B-%E4%BF%AE%E5%A4%8Dbug" class="sidebar-link">四.修复Bug</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="#_1-%E7%A9%BF%E6%A2%AD%E5%90%8E%E6%B8%85%E7%A9%BA%E9%80%89%E4%B8%AD%E5%88%97%E8%A1%A8" class="sidebar-link">1.穿梭后清空选中列表</a></li><li class="sidebar-sub-header"><a href="#_2-%E8%A2%AB%E7%A6%81%E7%94%A8%E5%85%83%E7%B4%A0%E4%B8%8D%E6%94%AF%E6%8C%81%E7%A9%BF%E6%A2%AD" class="sidebar-link">2.被禁用元素不支持穿梭</a></li></ul></li></ul></li><li><a href="5.html" class="sidebar-link">从零搭建Vue3.0组件库之折叠菜单</a></li><li><a href="6.html" class="sidebar-link">从零搭建Vue3.0组件库之无限滚动组件</a></li><li><a href="7.html" class="sidebar-link">从零搭建Vue3.0组件库之输入框组件</a></li><li><a href="8.html" class="sidebar-link">从零搭建Vue3.0组件库之表单组件</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="从零搭建vue3-0组件库之transfer组件"><a href="#%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BAvue3-0%E7%BB%84%E4%BB%B6%E5%BA%93%E4%B9%8Btransfer%E7%BB%84%E4%BB%B6" aria-hidden="true" class="header-anchor">#</a> 从零搭建Vue3.0组件库之Transfer组件</h1> <h2 id="一-定义组件属性"><a href="#%E4%B8%80-%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E5%B1%9E%E6%80%A7" aria-hidden="true" class="header-anchor">#</a> 一.定义组件属性</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">type</span> Key <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> DataItem <span class="token operator">=</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> Key
    label<span class="token punctuation">:</span> <span class="token builtin">string</span>
    disabled<span class="token punctuation">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> Props <span class="token operator">=</span> <span class="token punctuation">{</span>                    <span class="token comment">// 别名</span>
    key<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>     <span class="token comment">// key =&gt; id;</span>
    label<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>   <span class="token comment">// label =&gt; desc</span>
    disabled<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token comment">// disabled =&gt; dis</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">TransferProps</span> <span class="token punctuation">{</span>         <span class="token comment">// 穿梭框需要的数据 </span>
    data<span class="token punctuation">:</span> DataItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 默认类型</span>
    modelValue<span class="token punctuation">:</span> Key<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 当前选中的是</span>
    props<span class="token punctuation">:</span> Props       <span class="token comment">// 可改名</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="二-定义组件结构"><a href="#%E4%BA%8C-%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%BB%93%E6%9E%84" aria-hidden="true" class="header-anchor">#</a> 二.定义组件结构</h2> <blockquote><p>左右panel和中间button结构</p></blockquote> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 左边穿梭框 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TransferPanel</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TransferPanel</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer__buttons<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-icon-arrow-left-bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-button</span><span class="token punctuation">&gt;</span></span> 
      <span class="token entity" title="&amp;nbsp;">&amp;nbsp;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-icon-arrow-right-bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 左边穿梭框 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TransferPanel</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TransferPanel</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> TransferPanel <span class="token keyword">from</span> <span class="token string">&quot;./transfer-panel&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ZButton <span class="token keyword">from</span> <span class="token string">&quot;@z-ui/button&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">&quot;ZTransfer&quot;</span><span class="token punctuation">,</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    TransferPanel<span class="token punctuation">,</span>
    ZButton<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Array <span class="token keyword">as</span> PropType<span class="token operator">&lt;</span>DataItem<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">default</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    modelValue<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Array <span class="token keyword">as</span> PropType<span class="token operator">&lt;</span>Key<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">default</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Object <span class="token keyword">as</span> PropType<span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">default</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        label<span class="token punctuation">:</span> <span class="token string">&quot;label&quot;</span><span class="token punctuation">,</span>
        key<span class="token punctuation">:</span> <span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span>
        disabled<span class="token punctuation">:</span> <span class="token string">&quot;disabled&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><blockquote><p>panel面板主要有:面板头部和面板体</p></blockquote> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel__header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        列表
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel__body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
       ----
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="三-实现穿梭功能"><a href="#%E4%B8%89-%E5%AE%9E%E7%8E%B0%E7%A9%BF%E6%A2%AD%E5%8A%9F%E8%83%BD" aria-hidden="true" class="header-anchor">#</a> 三.实现穿梭功能</h2> <h3 id="_1-左右面板数据进行拆分"><a href="#_1-%E5%B7%A6%E5%8F%B3%E9%9D%A2%E6%9D%BF%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E6%8B%86%E5%88%86" aria-hidden="true" class="header-anchor">#</a> 1.左右面板数据进行拆分</h3> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- 左边穿梭框 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TransferPanel</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sourceData<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>props<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TransferPanel</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 左边穿梭框 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TransferPanel</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>targetData<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>props<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TransferPanel</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.计算 左右数据</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> propsKey<span class="token punctuation">,</span> sourceData<span class="token punctuation">,</span> targetData <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useComputedData</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      sourceData<span class="token punctuation">,</span>
      targetData<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>根据所有数据和key，进行数据的筛查  useComputedData.ts</p></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vue/runtime-core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TransferProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./transfer.type&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useComputedData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">:</span> TransferProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> propsKey <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>props<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> dataObj <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> props<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">memo<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            memo<span class="token punctuation">[</span>cur<span class="token punctuation">[</span>propsKey<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> cur<span class="token punctuation">;</span>
            <span class="token keyword">return</span> memo
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 根据key 映射原来的对象</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 通过key 进行数据筛选</span>
    <span class="token keyword">const</span> sourceData <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> props<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>props<span class="token punctuation">.</span>modelValue<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>propsKey<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 目标数据</span>
    <span class="token keyword">const</span> targetData <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> props<span class="token punctuation">.</span>modelValue<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> val <span class="token operator">=</span> dataObj<span class="token punctuation">.</span>value<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 根据key 映射值，存放到数组中</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> arr
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        propsKey<span class="token punctuation">,</span>
        sourceData<span class="token punctuation">,</span>
        targetData
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_2-面板渲染内容"><a href="#_2-%E9%9D%A2%E6%9D%BF%E6%B8%B2%E6%9F%93%E5%86%85%E5%AE%B9" aria-hidden="true" class="header-anchor">#</a> 2.面板渲染内容</h3> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel__header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-checkbox</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-checkbox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel__body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-checkbox-group</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel__list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-checkbox</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>z-transfer-panel__item<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item in data<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item[keyProp]<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item[keyProp]<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item[disabledProp]<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span> {{item[labelProp]}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-checkbox</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-checkbox-group</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ZCheckbox <span class="token keyword">from</span> <span class="token string">&quot;@z-ui/checkbox&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ZCheckboxGroup <span class="token keyword">from</span> <span class="token string">&quot;@z-ui/checkbox-group&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>useCheck<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./useCheck'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    ZCheckbox<span class="token punctuation">,</span>
    ZCheckboxGroup<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Array<span class="token punctuation">,</span>
      <span class="token function-variable function">default</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span><span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> Object <span class="token keyword">as</span> PropType<span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> labelProp<span class="token punctuation">,</span> keyProp<span class="token punctuation">,</span> disabledProp <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useCheck</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        labelProp<span class="token punctuation">,</span>
        keyProp<span class="token punctuation">,</span>
        disabledProp
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><blockquote><p>获取数据信息</p></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vue/runtime-core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">TransferPanelProps</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    props<span class="token punctuation">:</span> Props
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCheck</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">:</span> TransferPanelProps</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> labelProp <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>props<span class="token punctuation">.</span>label<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> keyProp <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>props<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> disabledProp <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>props<span class="token punctuation">.</span>disabled<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        labelProp<span class="token punctuation">,</span>
        keyProp<span class="token punctuation">,</span>
        disabledProp
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_3-获取当前选中的值"><a href="#_3-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E4%B8%AD%E7%9A%84%E5%80%BC" aria-hidden="true" class="header-anchor">#</a> 3.获取当前选中的值</h3> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-checkbox</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>allChecked<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleAllCheckedChange<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-checkbox</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> panelState <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    checked<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 选中的值</span>
    allChecked<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否全选</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">updateAllChecked</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> checkableDataKeys <span class="token operator">=</span> props<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">[</span>keyProp<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    panelState<span class="token punctuation">.</span>allChecked <span class="token operator">=</span> checkableDataKeys<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> checkableDataKeys<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> panelState<span class="token punctuation">.</span>checked<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> panelState<span class="token punctuation">.</span>checked<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">updateAllChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 更新全选状态</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'checked-change'</span><span class="token punctuation">,</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleAllCheckedChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">:</span> Key<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 更新checked</span>
    panelState<span class="token punctuation">.</span>checked <span class="token operator">=</span> value <span class="token operator">?</span> props<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">[</span>keyProp<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>每次选中的时候，将选中的结果传递给父组件</p></blockquote> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TransferPanel</span>
      <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sourceData<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>props<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@checked-change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onSourceCheckedChange<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TransferPanel</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TransferPanel</span>
      <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>targetData<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:props</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>props<span class="token punctuation">&quot;</span></span>
	  <span class="token attr-name">@checked-change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onTargetCheckedChange<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TransferPanel</span><span class="token punctuation">&gt;</span></span>
const checkedState = reactive({
    leftChecked: [],
    rightChecked: [],
});
const onSourceCheckedChange = (val) =&gt; {
    checkedState.leftChecked = val;
};
const onTargetCheckedChange = (val) =&gt; {
    checkedState.rightChecked = val;
};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p>将左右选中的内容分别存储到对应的数组中</p></blockquote> <h3 id="_4-穿梭实现"><a href="#_4-%E7%A9%BF%E6%A2%AD%E5%AE%9E%E7%8E%B0" aria-hidden="true" class="header-anchor">#</a> 4.穿梭实现</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token function-variable function">addToLeft</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 减少modelValue中的值</span>
    <span class="token keyword">const</span> currentValue <span class="token operator">=</span> props<span class="token punctuation">.</span>modelValue<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    checkedState<span class="token punctuation">.</span>rightChecked<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> index <span class="token operator">=</span> currentValue<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            currentValue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:modelValue&quot;</span><span class="token punctuation">,</span> currentValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">addToRight</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> currentValue <span class="token operator">=</span> props<span class="token punctuation">.</span>modelValue<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 给modelValue添加值</span>
    <span class="token keyword">const</span> itemsToBeMoved <span class="token operator">=</span> props<span class="token punctuation">.</span>data <span class="token comment">// 在所有数据中晒出选中的</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            checkedState<span class="token punctuation">.</span>leftChecked<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>propsKey<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span>
           <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">[</span>propsKey<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    currentValue <span class="token operator">=</span> currentValue<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>itemsToBeMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>currentValue<span class="token punctuation">)</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:modelValue&quot;</span><span class="token punctuation">,</span> currentValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="四-修复bug"><a href="#%E5%9B%9B-%E4%BF%AE%E5%A4%8Dbug" aria-hidden="true" class="header-anchor">#</a> 四.修复Bug</h2> <h3 id="_1-穿梭后清空选中列表"><a href="#_1-%E7%A9%BF%E6%A2%AD%E5%90%8E%E6%B8%85%E7%A9%BA%E9%80%89%E4%B8%AD%E5%88%97%E8%A1%A8" aria-hidden="true" class="header-anchor">#</a> 1.穿梭后清空选中列表</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> checked <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    panelState<span class="token punctuation">.</span>checked <span class="token operator">=</span> checked<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-被禁用元素不支持穿梭"><a href="#_2-%E8%A2%AB%E7%A6%81%E7%94%A8%E5%85%83%E7%B4%A0%E4%B8%8D%E6%94%AF%E6%8C%81%E7%A9%BF%E6%A2%AD" aria-hidden="true" class="header-anchor">#</a> 2.被禁用元素不支持穿梭</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> checkableData <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">// 过滤禁用的数据</span>
 	<span class="token keyword">return</span> props<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>item<span class="token punctuation">[</span>disabledProp<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">updateAllChecked</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 更新checkall</span>
    <span class="token keyword">const</span> checkableDataKeys <span class="token operator">=</span> checkableData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">[</span>keyProp<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    panelState<span class="token punctuation">.</span>allChecked <span class="token operator">=</span> checkableDataKeys<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> checkableDataKeys<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> panelState<span class="token punctuation">.</span>checked<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleAllCheckedChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">:</span> Key<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 更新checked</span>
    panelState<span class="token punctuation">.</span>checked <span class="token operator">=</span> value <span class="token operator">?</span> checkableData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">[</span>keyProp<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="3.html" class="prev">
          从零搭建Vue3.0组件库之checkbox组件
        </a></span> <span class="next"><a href="5.html">
          从零搭建Vue3.0组件库之折叠菜单
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="../assets/js/app.54b07399.js" defer></script><script src="../assets/js/2.ee950734.js" defer></script><script src="../assets/js/113.17422ed4.js" defer></script>
  </body>
</html>
